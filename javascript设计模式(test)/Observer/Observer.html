<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        <!--麻痹 不明白-->
        function Oberver(){
            this.oberverList=[];
        }
        Oberver.prototype.Add=function(obj){
            return this.oberverList.push(obj)
        };
        Oberver.prototype.Empty=function () {
            this.oberverList=[];
        };
        Oberver.prototype.Count=function(){
            return this.oberverList.length;
        };
        Oberver.prototype.Get=function(index){
            if(index>-1 || index<this.oberverList.length){
                return this.oberverList[index];
            }
        };
        Oberver.prototype.Insert=function(obj,index){
            var pointer=-1;
            if(index===0){
//                前面添加
                this.oberverList.unshift(obj);
                pointer=index;
            }else if(index===this.oberverList.length){
//                后面添加
                this.oberverList.push(obj);
                pointer=index;
            }
            return pointer
        };
        Oberver.prototype.IndexOf=function(obj,startIndex){
            var i=startIndex,pointer=-1;
            while(i<this.oberverList.length){
                if(this.oberverList[i]===obj){
                    pointer=i
                }
                i++
            }
            return pointer;

        };
        Oberver.prototype.RemoveIndexAt=function(index){
            if(index===0){
                this.oberverList.shift();
            }else if(index===this.oberverList.length-1){
                this.oberverList.pop()
            }else{
//                Tlmis oberverList.splicecind
            };

        };
        function extend(obj,extension){
            for(var key in obj){
                extension[key]=obj[key]
            }
        }
        function Subject(){
            this.observers=new Oberver();
        }
        Subject.prototype.AddObserver=function(observer){
            this.observers.Add(observer)
        }
        Subject.prototype.RemoveObserver=function(observer){
            this.observers.RemoveIndexAt(this.observers.IndexOf(observer,0));
        }
        Subject.prototype.Notify=function(context){
            var observerCount=this.observers.Count();
            for(var i=0;i<observerCount;i++){
                    this.observers.Get(i).Update(context);
            }
        }
        function Observer(){
            this.Update=function(){

            }
        }
    </script>
</head>
<body>
<button id="addNew">Add New </button>
<input id="mainCheckbox" type="checkbox">
<div id="observersContainer" style="width: 100px;height: 30px;background: #232323">111</div>

<script>
    var controlCheckbox=document.getElementById("mainCheckbox");
    var addBtn=document.querySelector("#addNew");
    var container=document.querySelector("#observersContainer");

    extend(new Subject(),controlCheckbox);

//    controlCheckbox.onclick=new Function("controlCheckbox.Notify controlCheckbox.checked");

    addBtn.onclick=AddNewObserver;
    console.log(Oberver)
    function AddNewObserver(){
        var check= document.createElement("input");
        check.type="checkbox";
        extend(new Oberver(),check);
        check.Update=function (val) {
            this.checked=val;
        }
            console.log(Oberver.Add)
        controlCheckbox.AddObserver(check);
        container.appendChild(check);
    }
</script>
</body>
</html>