<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        <!--麻痹 不明白-->
       function ObserverListi(){
           this.observer=[];
       }
        ObserverListi.prototype.add=function(obj){
            return this.observer.push(obj)
        };
        ObserverListi.prototype.Empty=function(){
            return this.observer=[];
        };
        ObserverListi.prototype.Count=function(){
            return this.observer.length;
        };
        ObserverListi.prototype.Get=function(index){
            if(index>-1 && index<this.observer.length){
                return this.observerList[index];
            }
        };
        ObserverListi.prototype.Insert=function(obj,index){
            var pointer=-1;
            if(index===0){
                this.observer.unshift(obj)
            }else if(index===this.observer.length){
                this.observer.push(obj);
                pointer=index;
            }
            return pointer
        };
        ObserverListi.prototype.IndexOf=function(obj,startIndex){
            var i=startIndex,pointer=-1;
            while(this.observer.length){
                if(this.observer[i]==obj){
                    pointer=i
                }
                i++
            }
            return pointer
        };
        ObserverListi.prototype.RemoveIndexAt=function(){
            if(index===0){
                this.observer.shift();
            }else if(index===this.observer.length){
                this.observer.pop();
            }else{

            }
        };


        function Subject (){
            this.observers=new ObserverListi();
        }
        Subject.prototype.AddObserver=function(observer){
            this.observers.add(observer);
        };
        Subject.prototype.RemoveObserver=function(observer){
            this.observers.RemoveIndexAt(this.observers.IndexOf(observer,0));
        };
        Subject.prototype.Notify=function(){
            var observerCount=this.observer.Count();
            for(var i=0;i<observerCount;i++){
                this.observers.Get(i).Update(context);
            }
        };
        function Observer(){
            this.Update=function(){

            };
        }






        function extend(obj,extension){
            for(var key in obj){
                extension[key]=obj[key]
            }
        }

    </script>
</head>
<body>
<button id="addNew">Add New </button>
<input id="mainCheckbox" type="checkbox">
<div id="observersContainer" style="width: 100px;height: 30px;background: #232323">111</div>
<script>
    var controlCheckbox=document.getElementById("mainCheckbox");
    var addBtn=document.querySelector("#addNew");
    var container=document.querySelector("#observersContainer");

    extend(new Subject(),controlCheckbox);

//    controlCheckbox.onclick=new Function("controlCheckbox.Notify controlCheckbox.checked");

    addBtn.onclick=AddNewObserver;
    console.log(Subject)
    function AddNewObserver(){
        var i=0;
        var check= document.createElement("input");
        check.type="checkbox";
        extend(new Subject(),controlCheckbox);
        check.Update=function (val) {
            this.checked=val+1;
            i++
        };
        controlCheckbox.AddObserver(check);
        container.appendChild(check);
    }
</script>
</body>
</html>